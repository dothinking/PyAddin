# PyAddin

PyAddin is an Excel addin template with customized Ribbon menu and a combination of VBA and Python. VBA calls Python script by console arguments, and gets return from running results. So it's easily extended to your own application.

**Shown with VBA and Driven by Python**

---

## Quick Start

1. Set Python path for this addin

If embeddable Python is applied, a relative path would be recommended.

```
# common line starts with #
# set path for python interpreter
# relative path is allowable

[python]
\python\python.exe
```

2. Fill VBA callback functions generated automatically by [`autoUI`](../autoUI)

```vba
Sub callback_cal(control As IRibbonControl)

    '''
    ' This Sub is created by `AUTOUI`, please fill the body manually,
    ' where you could use pre-defined function `RunPython()` to call
    ' specified python script.
    '
    '''
    
    Dim a1$, a2$, args, res$
    
    a1 = ActiveSheet.Range("A1").Value
    a2 = ActiveSheet.Range("A2").Value
    
    args = Array(a1, a2)
    If RunPython("scripts.test.division", args, res) Then
        ActiveSheet.Range("A3").Value = res
    Else
        MsgBox res
    End If
    
End Sub
```

`RunPython` is a pre-defined VBA function to call Python scripts from command line, and check return from output/error file generated by the called Python script. The first argument, "scripts.test.division" in this case, refers to the called method.

3. Create Python script under `scripts` to do the main work

```python
# scripts/test.py

def division(a, b):
	assert a!='', 'cell A1 is empty'
	assert b!='', 'cell A2 is empty'
	return float(a)/float(b)
```